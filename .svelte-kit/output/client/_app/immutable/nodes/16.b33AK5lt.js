import"../chunks/disclose-version.Bg9kRutz.js";import{f as Ve,p as we,t as H,a as ke,s as r,c as a,r as t,d as h,b as c,g as e,n as ee,e as te}from"../chunks/utils.CRNn4dtP.js";import{s as q}from"../chunks/render.xPn1qZIb.js";import{i as J}from"../chunks/if.CRsBAEFG.js";import{e as lt,i as dt}from"../chunks/each.v0RK4Yef.js";import{c as ct,a as I,d as Se,f as Ge,t as z,s as vt,b as _t}from"../chunks/store.B1kL-7Ni.js";import{c as N,r as ut}from"../chunks/attributes.BcfEV1VJ.js";import{b as S}from"../chunks/input.o7SqHMM4.js";import{b as mt}from"../chunks/select.CgyWjfO5.js";import{l as gt,s as ft,a as F}from"../chunks/preload-helper.Dwm_PvIR.js";import{o as pt}from"../chunks/index-client.BdGz_wQc.js";import{s as L}from"../chunks/supabaseClient.BTuNJN2N.js";import{p as bt}from"../chunks/stores.DcEtjLim.js";import{g as xt}from"../chunks/entry.DOGBvY7d.js";import{E as yt,a as ht}from"../chunks/jspdf.plugin.autotable.hR4uI5lc.js";import{C as wt}from"../chunks/chevron-left.Ykq-ocAp.js";import{P as kt}from"../chunks/plus.BBSv_QI7.js";import{I as St,s as Pt}from"../chunks/Icon.CEA2x5sb.js";import{S as jt}from"../chunks/search.B4Eo5Hu8.js";import{A as Et}from"../chunks/arrow-up-down.Ck2frNgV.js";import{E as Ot}from"../chunks/eye.C9SOZpvn.js";import{P as qt}from"../chunks/pencil.DHUYAf-P.js";function It(x,s){const i=gt(s,["children","$$slots","$$events","$$legacy"]);St(x,ft({name:"file-down"},()=>i,{iconNode:[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M12 18v-6"}],["path",{d:"m9 15 3 3 3-3"}]],children:(g,_)=>{var n=ct(),f=Ve(n);Pt(f,s,"default",{}),I(g,n)},$$slots:{default:!0}}))}var Nt=z('<form class="space-y-4"><h3 class="text-lg font-semibold">Edit Strategic Objective</h3> <div><label for="name" class="block text-sm font-medium mb-1">Strategic Objective</label> <textarea id="name" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="strategic_initiatives" class="block text-sm font-medium mb-1">Strategic Initiatives</label> <textarea id="strategic_initiatives" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="kpi" class="block text-sm font-medium mb-1">KPI</label> <textarea id="kpi" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="persons_involved" class="block text-sm font-medium mb-1">Persons Involved</label> <textarea id="persons_involved" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="target" class="block text-sm font-medium mb-1">Target</label> <textarea id="target" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="eval_measures" class="block text-sm font-medium mb-1">Evaluation Measures</label> <textarea id="eval_measures" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div class="flex justify-end gap-2 pt-4"><button type="button" class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"> </button></div></form>');function Dt(x,s){we(s,!0);let i=F({name:s.objective.name,strategic_initiatives:s.objective.strategic_initiatives,kpi:s.objective.kpi,persons_involved:s.objective.persons_involved,target:s.objective.target,eval_measures:s.objective.eval_measures});const $=l=>{l.preventDefault(),s.onSave(i)};var g=Nt(),_=r(a(g),2),n=r(a(_),2);N(n),t(_);var f=r(_,2),D=r(a(f),2);N(D),t(f);var b=r(f,2),v=r(a(b),2);N(v),t(b);var w=r(b,2),C=r(a(w),2);N(C),t(w);var p=r(w,2),u=r(a(p),2);N(u),t(p);var P=r(p,2),M=r(a(P),2);N(M),t(P);var T=r(P,2),V=a(T);V.__click=function(...l){var K;(K=s.onCancel)==null||K.apply(this,l)};var j=r(V,2),Y=a(j,!0);t(j),t(T),t(g),H(()=>{j.disabled=s.isSaving,q(Y,s.isSaving?"Saving...":"Save")}),Ge("submit",g,$),S(n,()=>i.name,l=>i.name=l),S(D,()=>i.strategic_initiatives,l=>i.strategic_initiatives=l),S(v,()=>i.kpi,l=>i.kpi=l),S(C,()=>i.persons_involved,l=>i.persons_involved=l),S(u,()=>i.target,l=>i.target=l),S(M,()=>i.eval_measures,l=>i.eval_measures=l),I(x,g),ke()}Se(["click"]);var Ct=z('<form class="space-y-4"><h3 class="text-lg font-semibold">Add Strategic Objective</h3> <div><label for="name" class="block text-sm font-medium mb-1">Strategic Objective</label> <textarea id="name" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="strategic_initiatives" class="block text-sm font-medium mb-1">Strategic Initiatives</label> <textarea id="strategic_initiatives" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="kpi" class="block text-sm font-medium mb-1">KPI</label> <textarea id="kpi" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="persons_involved" class="block text-sm font-medium mb-1">Persons Involved</label> <textarea id="persons_involved" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="target" class="block text-sm font-medium mb-1">Target</label> <textarea id="target" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="eval_measures" class="block text-sm font-medium mb-1">Evaluation Measures</label> <textarea id="eval_measures" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div class="flex justify-end gap-2 pt-4"><button type="button" class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"> </button></div></form>');function Ft(x,s){we(s,!0);let i=F({name:"",strategic_initiatives:"",kpi:"",persons_involved:"",target:"",eval_measures:""});const $=l=>{l.preventDefault(),s.onSave(i)};var g=Ct(),_=r(a(g),2),n=r(a(_),2);N(n),t(_);var f=r(_,2),D=r(a(f),2);N(D),t(f);var b=r(f,2),v=r(a(b),2);N(v),t(b);var w=r(b,2),C=r(a(w),2);N(C),t(w);var p=r(w,2),u=r(a(p),2);N(u),t(p);var P=r(p,2),M=r(a(P),2);N(M),t(P);var T=r(P,2),V=a(T);V.__click=function(...l){var K;(K=s.onCancel)==null||K.apply(this,l)};var j=r(V,2),Y=a(j,!0);t(j),t(T),t(g),H(()=>{j.disabled=s.isSaving,q(Y,s.isSaving?"Saving...":"Save")}),Ge("submit",g,$),S(n,()=>i.name,l=>i.name=l),S(D,()=>i.strategic_initiatives,l=>i.strategic_initiatives=l),S(v,()=>i.kpi,l=>i.kpi=l),S(C,()=>i.persons_involved,l=>i.persons_involved=l),S(u,()=>i.target,l=>i.target=l),S(M,()=>i.eval_measures,l=>i.eval_measures=l),I(x,g),ke()}Se(["click"]);const zt=(x,s,i,$,g,_)=>{const n=new yt("landscape","mm","a4");n.setFontSize(18),n.text("Strategic Objectives",14,20),e(s)&&(n.setFontSize(12),n.text(`Goal Name: ${e(s).name}`,14,30),n.text(`Lead: ${e(s).lead}`,14,37));const f=e(i).map(u=>[u.name,u.strategic_initiatives,u.kpi,u.persons_involved,u.target,u.eval_measures]);ht(n,{head:[["Strategic Objectives","Strategic Initiatives","KPI","Persons Involved","Target","Evaluation Measures"]],body:f,startY:58,theme:"grid",styles:{fontSize:10}});const v=n.internal.pageSize.height-30;n.setFontSize(12);const w=e($)||"Admin Name",C=e(g)||"Vice President Name",p=e(_)||"President Name";n.text(`${w}(sgnd)`,14,v-5),n.text("_________________________",14,v),n.text("Corporate Planning Officer",14,v+5),n.text(`${C}`,100,v-5),n.text("_________________________",100,v),n.text("Vice President",100,v+5),n.text(`${p}`,180,v-5),n.text("_________________________",180,v),n.text("President",180,v+5),n.save("StrategicObjectives.pdf")};var At=z('<div class="flex justify-center items-center min-h-[200px]"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),$t=z('<div class="mt-2 text-muted-foreground"><p><span class="font-medium text-foreground">Goal Name:</span> </p> <p><span class="font-medium text-foreground">Lead:</span> </p></div>'),Mt=(x,s)=>c(s,!0),Tt=z('<div class="bg-card rounded-lg p-4 border border-border"><!></div>'),Vt=z('<div class="bg-card rounded-lg p-4 border border-border"><!></div>'),Gt=(x,s)=>s("name"),Lt=(x,s,i)=>s(e(i).id),Kt=(x,s,i)=>c(s,F(e(i))),Ht=z('<tr class="hover:bg-muted/50"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"><div class="flex justify-center gap-2"><button class="btn btn-ghost" title="View plans"><!></button> <button class="btn btn-ghost btn-sm"><!></button></div></td></tr>'),Yt=(x,s)=>c(s,e(s)-1),Bt=(x,s)=>c(s,e(s)+1),Qt=z('<div class="flex flex-col md:flex-row gap-4"><div class="relative flex-3"><!> <input type="text" placeholder="Search objectives..." class="pl-10 pr-4 py-2 bg-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <select class="bg-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring w-full md:w-[150px]"><option>5 per page</option><option>10 per page</option><option>25 per page</option><option>50 per page</option></select></div> <div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><table class="min-w-full table-auto"><thead class="bg-muted/50"><tr><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Strategic Objectives <!></button></th><th class="px-4 py-3 text-left">Strategic Initiatives</th><th class="px-4 py-3 text-left">KPI</th><th class="px-4 py-3 text-left">Persons Involved</th><th class="px-4 py-3 text-left">Target</th><th class="px-4 py-3 text-left">Evaluation Measures</th><th class="px-4 py-3 text-center w-[200px]">Actions</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div> <div class="flex flex-col sm:flex-row justify-between items-center gap-4"><div class="text-sm text-muted-foreground"> </div> <div class="flex gap-2"><button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Previous</button> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Next</button></div></div>',1),Zt=(x,s)=>c(s,!0),Jt=z('<div class="text-center py-12 bg-card rounded-lg border border-border"><p class="text-muted-foreground mb-4">No objectives found for this goal.</p> <button class="btn btn-primary">Add Strategic Objectives</button></div>'),Rt=z('<div class="flex flex-col gap-6"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div><a href="/plans" class="flex items-center gap-2 text-muted-foreground mb-2 hover:text-foreground"><!> Back to Goals</a> <h1 class="text-3xl font-bold"> </h1> <!></div> <div class="flex flex-col sm:flex-row gap-2"><button class="flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 justify-center whitespace-nowrap w-full md:w-auto"><!> Add Objectives</button> <button class="flex items-center gap-2 bg-secondary text-foreground px-4 py-2 rounded-lg hover:bg-secondary/80 justify-center flex-1 md:flex-initial whitespace-nowrap"><!> Export PDF</button></div></div> <!> <!> <!></div>'),Ut=z('<div class="container mx-auto p-4"><!></div>');function yr(x,s){we(s,!0);const i=vt(),$=()=>_t(bt,"$page",i);let g=h(""),_=h(1),n=h(5),f=h("name"),D=h("asc"),b=h(null),v=h(null),w=h(F([])),C=h(!0),p=h(null),u=h(!1),P=h(!1),M=h(null),T=h(null),V=h(null);const j=te(()=>e(w).filter(o=>`${o.name} ${o.strategic_initiatives} ${o.kpi} ${o.persons_involved}`.toLowerCase().includes(e(g).toLowerCase())).sort((o,d)=>{const y=String(o[e(f)]),E=String(d[e(f)]);return e(D)==="asc"?y.localeCompare(E):E.localeCompare(y)})),Y=te(()=>e(j).slice((e(_)-1)*e(n),e(_)*e(n))),l=te(()=>Math.ceil(e(j).length/e(n))),K=o=>{e(f)===o?c(D,F(e(D)==="asc"?"desc":"asc")):(c(f,F(o)),c(D,"asc"))},Pe=async o=>{c(P,!0);try{if(e(p)){const{error:d}=await L.from("strategic_objectives").update(o).eq("id",e(p).id);if(d)throw d}else{const{error:d}=await L.from("strategic_objectives").insert({...o,strategic_goal_id:e(b)});if(d)throw d}await je(),c(p,null),c(u,!1)}catch(d){console.error("Error saving objective:",d)}finally{c(P,!1)}},Le=o=>{e(b)!==null&&xt(`/plans/${e(b)}/${o}`)},Ke=async()=>{try{const{data:{session:o}}=await L.auth.getSession();if(!o||!o.user)return;const{data:d,error:y}=await L.from("profiles").select("first_name, last_name").eq("id",o.user.id).single();y?console.error("Error fetching admin name:",y):d&&c(M,`${d.first_name} ${d.last_name}`)}catch(o){console.error("Error fetching admin details:",o)}},He=async()=>{try{const{data:o,error:d}=await L.from("profiles").select("first_name, last_name, role").in("role",["vice_president","president"]);if(d){console.error("Error fetching VP and President names:",d);return}const y=o==null?void 0:o.find(A=>A.role==="vice_president"),E=o==null?void 0:o.find(A=>A.role==="president");c(T,F(y?`${y.first_name} ${y.last_name}`:"N/A")),c(V,F(E?`${E.first_name} ${E.last_name}`:"N/A"))}catch(o){console.error("Error fetching VP and President details:",o)}},je=async()=>{if(e(b)!==null){c(C,!0);try{const{data:o,error:d}=await L.from("strategic_goals").select("id, name, goal_no, lead_id").eq("id",e(b)).single();if(d||!o)throw new Error("Failed to fetch goal details");if(c(v,F({id:o.id,name:o.name,goal_no:o.goal_no,lead:""})),o.lead_id){const{data:A,error:R}=await L.from("leads").select("name").eq("id",o.lead_id).single();R?console.error("Error fetching lead name:",R):A&&(e(v).lead=A.name)}const{data:y,error:E}=await L.from("strategic_objectives").select("*").eq("strategic_goal_id",e(b));if(E)throw new Error("Failed to fetch objectives");c(w,F(y||[]))}catch(o){console.error(o)}finally{c(C,!1)}}};pt(()=>{c(b,F($().params.id?parseInt($().params.id):null)),je(),Ke(),He()});var re=Ut(),Ye=a(re);J(Ye,()=>e(C),o=>{var d=At();I(o,d)},o=>{var d=Rt(),y=a(d),E=a(y),A=a(E),R=a(A);wt(R,{size:20}),ee(),t(A);var ae=r(A,2),Be=a(ae);t(ae);var Qe=r(ae,2);J(Qe,()=>e(v),O=>{var m=$t(),k=a(m),B=r(a(k));t(k);var Q=r(k,2),W=r(a(Q));t(Q),t(m),H(()=>{q(B,` ${e(v).name??""}`),q(W,` ${e(v).lead??""}`)}),I(O,m)}),t(E);var Ee=r(E,2),U=a(Ee);U.__click=[Mt,u];var Ze=a(U);kt(Ze,{size:20}),ee(),t(U);var se=r(U,2);se.__click=[zt,v,w,M,T,V];var Je=a(se);It(Je,{size:20}),ee(),t(se),t(Ee),t(y);var Oe=r(y,2);J(Oe,()=>e(u),O=>{var m=Tt(),k=a(m);Ft(k,{get isSaving(){return e(P)},onSave:Pe,onCancel:()=>c(u,!1)}),t(m),I(O,m)});var qe=r(Oe,2);J(qe,()=>e(p),O=>{var m=Vt(),k=a(m);Dt(k,{get objective(){return e(p)},get isSaving(){return e(P)},onSave:Pe,onCancel:()=>c(p,null)}),t(m),I(O,m)});var Re=r(qe,2);J(Re,()=>e(w).length>0,O=>{var m=Qt(),k=Ve(m),B=a(k),Q=a(B);jt(Q,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var W=r(Q,2);ut(W),t(B);var oe=r(B,2),ie=a(oe);ie.value=(ie.__value=5)==null?"":5;var ne=r(ie);ne.value=(ne.__value=10)==null?"":10;var le=r(ne);le.value=(le.__value=25)==null?"":25;var Ie=r(le);Ie.value=(Ie.__value=50)==null?"":50,t(oe),t(k);var de=r(k,2),Ne=a(de),ce=a(Ne),De=a(ce),Ce=a(De),ve=a(Ce);ve.__click=[Gt,K];var Ue=r(a(ve)),We=te(()=>e(f)==="name"?"text-primary":"");Et(Ue,{size:16,get class(){return e(We)}}),t(ve),t(Ce),ee(6),t(De),t(ce);var Fe=r(ce);lt(Fe,21,()=>e(Y),dt,(Z,G)=>{var me=Ht(),ge=a(me),et=a(ge,!0);t(ge);var fe=r(ge),tt=a(fe,!0);t(fe);var pe=r(fe),rt=a(pe,!0);t(pe);var be=r(pe),at=a(be,!0);t(be);var xe=r(be),st=a(xe,!0);t(xe);var ye=r(xe),ot=a(ye,!0);t(ye);var Me=r(ye),Te=a(Me),X=a(Te);X.__click=[Lt,Le,G];var it=a(X);Ot(it,{size:18}),t(X);var he=r(X,2);he.__click=[Kt,p,G];var nt=a(he);qt(nt,{size:18}),t(he),t(Te),t(Me),t(me),H(()=>{q(et,e(G).name),q(tt,e(G).strategic_initiatives),q(rt,e(G).kpi),q(at,e(G).persons_involved),q(st,e(G).target),q(ot,e(G).eval_measures)}),I(Z,me)}),t(Fe),t(Ne),t(de);var ze=r(de,2),_e=a(ze),Xe=a(_e);H(()=>q(Xe,`Showing ${(e(_)-1)*e(n)+1} to ${Math.min(e(_)*e(n),e(j).length)??""} of ${e(j).length??""} results`)),t(_e);var Ae=r(_e,2),ue=a(Ae);ue.__click=[Yt,_];var $e=r(ue,2);$e.__click=[Bt,_],t(Ae),t(ze),H(()=>{ue.disabled=e(_)===1,$e.disabled=e(_)===e(l)}),S(W,()=>e(g),Z=>c(g,Z)),mt(oe,()=>e(n),Z=>c(n,Z)),I(O,m)},O=>{var m=Jt(),k=r(a(m),2);k.__click=[Zt,u],t(m),I(O,m)}),t(d),H(()=>{var O;return q(Be,`Strategic Objectives for Goal ${((O=e(v))==null?void 0:O.goal_no)??""}`)}),I(o,d)}),t(re),I(x,re),ke()}Se(["click"]);export{yr as component};
