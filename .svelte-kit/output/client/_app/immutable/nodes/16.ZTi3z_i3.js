import"../chunks/disclose-version.Bg9kRutz.js";import{p as we,t as Y,a as ke,s as r,c as a,r as t,e as y,b as v,g as e,f as nt,n as te,h as re}from"../chunks/utils.Cx6K9qTo.js";import{d as Se,g as Ge,a as N,t as A,b as E,s as lt,c as dt}from"../chunks/store.BALTJZ26.js";import{i as R}from"../chunks/if.Bgpzl8Wa.js";import{b as q,e as ct,r as vt,i as _t}from"../chunks/attributes.rzeD2olC.js";import{b as w}from"../chunks/input.BVFrb_g3.js";import{b as ut}from"../chunks/select.BtlRD387.js";import{a as z}from"../chunks/preload-helper.Tg4Km7Zr.js";import{o as mt}from"../chunks/index-client.lWLCSZVk.js";import{s as K}from"../chunks/Icon.Nl6wOSVO.js";import{p as gt}from"../chunks/stores.iWLj25CT.js";import{g as ft}from"../chunks/entry.CMKkUr-m.js";import{E as pt,a as bt}from"../chunks/jspdf.plugin.autotable.BCh_1lSd.js";import{C as xt}from"../chunks/chevron-left.BQoiznrZ.js";import{S as yt}from"../chunks/search.BpYLThKw.js";import{D as ht}from"../chunks/download.K4Jw1XP8.js";import{P as wt}from"../chunks/plus.Dop3u5ke.js";import{A as kt}from"../chunks/arrow-up-down.CZ0J7o1e.js";import{E as St}from"../chunks/eye.CaP1-WUo.js";import{P as Pt}from"../chunks/pencil.Brzv4RaD.js";var jt=A('<form class="space-y-4"><h3 class="text-lg font-semibold">Edit Strategic Objective</h3> <div><label for="name" class="block text-sm font-medium mb-1">Strategic Objective</label> <textarea id="name" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="strategic_initiatives" class="block text-sm font-medium mb-1">Strategic Initiatives</label> <textarea id="strategic_initiatives" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="kpi" class="block text-sm font-medium mb-1">KPI</label> <textarea id="kpi" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="persons_involved" class="block text-sm font-medium mb-1">Persons Involved</label> <textarea id="persons_involved" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="target" class="block text-sm font-medium mb-1">Target</label> <textarea id="target" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="eval_measures" class="block text-sm font-medium mb-1">Evaluation Measures</label> <textarea id="eval_measures" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div class="flex justify-end gap-2 pt-4"><button type="button" class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"> </button></div></form>');function Et(k,o){we(o,!0);let i=z({name:o.objective.name,strategic_initiatives:o.objective.strategic_initiatives,kpi:o.objective.kpi,persons_involved:o.objective.persons_involved,target:o.objective.target,eval_measures:o.objective.eval_measures});const T=n=>{n.preventDefault(),o.onSave(i)};var p=jt(),_=r(a(p),2),l=r(a(_),2);q(l),t(_);var b=r(_,2),O=r(a(b),2);q(O),t(b);var g=r(b,2),c=r(a(g),2);q(c),t(g);var h=r(g,2),D=r(a(h),2);q(D),t(h);var u=r(h,2),m=r(a(u),2);q(m),t(u);var S=r(u,2),V=r(a(S),2);q(V),t(S);var M=r(S,2),G=a(M);G.__click=function(...n){var H;(H=o.onCancel)==null||H.apply(this,n)};var P=r(G,2),B=a(P,!0);t(P),t(M),t(p),Y(()=>{P.disabled=o.isSaving,E(B,o.isSaving?"Saving...":"Save")}),Ge("submit",p,T),w(l,()=>i.name,n=>i.name=n),w(O,()=>i.strategic_initiatives,n=>i.strategic_initiatives=n),w(c,()=>i.kpi,n=>i.kpi=n),w(D,()=>i.persons_involved,n=>i.persons_involved=n),w(m,()=>i.target,n=>i.target=n),w(V,()=>i.eval_measures,n=>i.eval_measures=n),N(k,p),ke()}Se(["click"]);var qt=A('<form class="space-y-4"><h3 class="text-lg font-semibold">Add Strategic Objective</h3> <div><label for="name" class="block text-sm font-medium mb-1">Strategic Objective</label> <textarea id="name" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="strategic_initiatives" class="block text-sm font-medium mb-1">Strategic Initiatives</label> <textarea id="strategic_initiatives" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="kpi" class="block text-sm font-medium mb-1">KPI</label> <textarea id="kpi" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="persons_involved" class="block text-sm font-medium mb-1">Persons Involved</label> <textarea id="persons_involved" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="target" class="block text-sm font-medium mb-1">Target</label> <textarea id="target" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div><label for="eval_measures" class="block text-sm font-medium mb-1">Evaluation Measures</label> <textarea id="eval_measures" class="w-full p-2 rounded-md bg-secondary border-secondary focus:ring-2 focus:ring-ring" required rows="3"></textarea></div> <div class="flex justify-end gap-2 pt-4"><button type="button" class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"> </button></div></form>');function Ot(k,o){we(o,!0);let i=z({name:"",strategic_initiatives:"",kpi:"",persons_involved:"",target:"",eval_measures:""});const T=n=>{n.preventDefault(),o.onSave(i)};var p=qt(),_=r(a(p),2),l=r(a(_),2);q(l),t(_);var b=r(_,2),O=r(a(b),2);q(O),t(b);var g=r(b,2),c=r(a(g),2);q(c),t(g);var h=r(g,2),D=r(a(h),2);q(D),t(h);var u=r(h,2),m=r(a(u),2);q(m),t(u);var S=r(u,2),V=r(a(S),2);q(V),t(S);var M=r(S,2),G=a(M);G.__click=function(...n){var H;(H=o.onCancel)==null||H.apply(this,n)};var P=r(G,2),B=a(P,!0);t(P),t(M),t(p),Y(()=>{P.disabled=o.isSaving,E(B,o.isSaving?"Saving...":"Save")}),Ge("submit",p,T),w(l,()=>i.name,n=>i.name=n),w(O,()=>i.strategic_initiatives,n=>i.strategic_initiatives=n),w(c,()=>i.kpi,n=>i.kpi=n),w(D,()=>i.persons_involved,n=>i.persons_involved=n),w(m,()=>i.target,n=>i.target=n),w(V,()=>i.eval_measures,n=>i.eval_measures=n),N(k,p),ke()}Se(["click"]);const Dt=(k,o,i,T,p,_)=>{const l=new pt("landscape","mm","a4");l.setFontSize(18),l.text("Strategic Objectives",14,20),e(o)&&(l.setFontSize(12),l.text(`Goal Name: ${e(o).name}`,14,30),l.text(`Lead: ${e(o).lead}`,14,37));const b=e(i).map(m=>[m.name,m.strategic_initiatives,m.kpi,m.persons_involved,m.target,m.eval_measures]);bt(l,{head:[["Strategic Objectives","Strategic Initiatives","KPI","Persons Involved","Target","Evaluation Measures"]],body:b,startY:58,theme:"grid",styles:{fontSize:10}});const c=l.internal.pageSize.height-30;l.setFontSize(12);const h=e(T)||"Admin Name",D=e(p)||"Vice President Name",u=e(_)||"President Name";l.text(`${h}(sgnd)`,14,c-5),l.text("_________________________",14,c),l.text("Corporate Planning Officer",14,c+5),l.text(`${D}`,100,c-5),l.text("_________________________",100,c),l.text("Vice President",100,c+5),l.text(`${u}`,180,c-5),l.text("_________________________",180,c),l.text("President",180,c+5),l.save("StrategicObjectives.pdf")};var Ct=A('<div class="flex justify-center items-center min-h-[200px]"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),It=A('<div class="mt-2 text-muted-foreground"><p><span class="font-medium text-foreground">Goal Name:</span> </p> <p><span class="font-medium text-foreground">Lead:</span> </p></div>'),Nt=A('<div class="bg-card rounded-lg p-4 border border-border"><!></div>'),zt=A('<div class="bg-card rounded-lg p-4 border border-border"><!></div>'),At=(k,o)=>v(o,!0),Ft=(k,o)=>o("name"),Tt=(k,o,i)=>o(e(i).id),Vt=(k,o,i)=>v(o,z(e(i))),Mt=A('<tr class="hover:bg-muted/50"><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3"><div class="flex justify-center gap-2"><button class="p-1.5 hover:bg-primary/10 rounded-md transition-colors text-blue-500" title="View plans"><!></button> <button class="hover:bg-muted rounded-lg text-muted-foreground hover:text-foreground"><!></button></div></td></tr>'),Gt=(k,o)=>v(o,e(o)-1),Lt=(k,o)=>v(o,e(o)+1),Kt=A('<div class="flex flex-col md:flex-row justify-between items-center gap-4"><div class="relative flex-3 w-full md:max-w-[300px]"><!> <input type="text" placeholder="Search objectives..." class="pl-10 pr-4 py-2 bg-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <div class="flex gap-2"><button class="flex items-center gap-2 bg-secondary text-foreground px-4 py-2 rounded-lg hover:bg-secondary/80 justify-center whitespace-nowrap"><!> Export</button> <button class="flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 justify-center whitespace-nowrap"><!> Add Objectives</button></div></div> <div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><table class="min-w-full table-auto"><thead class="bg-muted/50"><tr><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Strategic Objectives <!></button></th><th class="px-4 py-3 text-left">Strategic Initiatives</th><th class="px-4 py-3 text-left">KPI</th><th class="px-4 py-3 text-left">Persons Involved</th><th class="px-4 py-3 text-left">Target</th><th class="px-4 py-3 text-left">Evaluation Measures</th><th class="px-4 py-3 text-center w-[200px]">Actions</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div> <div class="flex flex-col sm:flex-row justify-between items-center gap-4 mt-4"><div class="text-sm text-muted-foreground"> </div> <div class="flex gap-2 items-center"><select class="bg-secondary rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring"><option>5 per page</option><option>10 per page</option><option>25 per page</option><option>50 per page</option></select> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Previous</button> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Next</button></div></div>',1),Ht=A('<div class="text-center py-12 bg-card rounded-lg border border-border"><p class="text-muted-foreground mb-4">No objectives found for this goal.</p></div>'),Yt=A('<div class="flex flex-col gap-6"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div><a href="/plans" class="flex items-center gap-2 text-muted-foreground mb-2 hover:text-foreground"><!> Back to Goals</a> <h1 class="text-2xl font-bold"> </h1> <!></div></div> <!> <!> <!></div>'),Bt=A('<div class="container mx-auto p-4"><!></div>');function _r(k,o){we(o,!0);const i=lt(),T=()=>dt(gt,"$page",i);let p=y(""),_=y(1),l=y(5),b=y("name"),O=y("asc"),g=y(null),c=y(null),h=y(z([])),D=y(!0),u=y(null),m=y(!1),S=y(!1),V=y(null),M=y(null),G=y(null);const P=re(()=>e(h).filter(s=>`${s.name} ${s.strategic_initiatives} ${s.kpi} ${s.persons_involved}`.toLowerCase().includes(e(p).toLowerCase())).sort((s,d)=>{const x=String(s[e(b)]),C=String(d[e(b)]);return e(O)==="asc"?x.localeCompare(C):C.localeCompare(x)})),B=re(()=>e(P).slice((e(_)-1)*e(l),e(_)*e(l))),n=re(()=>Math.ceil(e(P).length/e(l))),H=s=>{e(b)===s?v(O,z(e(O)==="asc"?"desc":"asc")):(v(b,z(s)),v(O,"asc"))},Pe=async s=>{v(S,!0);try{if(e(u)){const{error:d}=await K.from("strategic_objectives").update(s).eq("id",e(u).id);if(d)throw d}else{const{error:d}=await K.from("strategic_objectives").insert({...s,strategic_goal_id:e(g)});if(d)throw d}await je(),v(u,null),v(m,!1)}catch(d){console.error("Error saving objective:",d)}finally{v(S,!1)}},Le=s=>{e(g)!==null&&ft(`/plans/${e(g)}/${s}`)},Ke=async()=>{try{const{data:{session:s}}=await K.auth.getSession();if(!s||!s.user)return;const{data:d,error:x}=await K.from("profiles").select("first_name, last_name").eq("id",s.user.id).single();x?console.error("Error fetching admin name:",x):d&&v(V,`${d.first_name} ${d.last_name}`)}catch(s){console.error("Error fetching admin details:",s)}},He=async()=>{try{const{data:s,error:d}=await K.from("profiles").select("first_name, last_name, role").in("role",["vice_president","president"]);if(d){console.error("Error fetching VP and President names:",d);return}const x=s==null?void 0:s.find(F=>F.role==="vice_president"),C=s==null?void 0:s.find(F=>F.role==="president");v(M,z(x?`${x.first_name} ${x.last_name}`:"N/A")),v(G,z(C?`${C.first_name} ${C.last_name}`:"N/A"))}catch(s){console.error("Error fetching VP and President details:",s)}},je=async()=>{if(e(g)!==null){v(D,!0);try{const{data:s,error:d}=await K.from("strategic_goals").select("id, name, goal_no, lead_id").eq("id",e(g)).single();if(d||!s)throw new Error("Failed to fetch goal details");if(v(c,z({id:s.id,name:s.name,goal_no:s.goal_no,lead:""})),s.lead_id){const{data:F,error:U}=await K.from("leads").select("name").eq("id",s.lead_id).single();U?console.error("Error fetching lead name:",U):F&&(e(c).lead=F.name)}const{data:x,error:C}=await K.from("strategic_objectives").select("*").eq("strategic_goal_id",e(g));if(C)throw new Error("Failed to fetch objectives");v(h,z(x||[]))}catch(s){console.error(s)}finally{v(D,!1)}}};mt(()=>{v(g,z(T().params.id?parseInt(T().params.id):null)),je(),Ke(),He()});var ae=Bt(),Ye=a(ae);R(Ye,()=>e(D),s=>{var d=Ct();N(s,d)},s=>{var d=Yt(),x=a(d),C=a(x),F=a(C),U=a(F);xt(U,{size:20}),te(),t(F);var se=r(F,2),Be=a(se);t(se);var Qe=r(se,2);R(Qe,()=>e(c),j=>{var f=It(),I=a(f),Q=r(a(I));t(I);var $=r(I,2),W=r(a($));t($),t(f),Y(()=>{E(Q,` ${e(c).name??""}`),E(W,` ${e(c).lead??""}`)}),N(j,f)}),t(C),t(x);var Ee=r(x,2);R(Ee,()=>e(m),j=>{var f=Nt(),I=a(f);Ot(I,{get isSaving(){return e(S)},onSave:Pe,onCancel:()=>v(m,!1)}),t(f),N(j,f)});var qe=r(Ee,2);R(qe,()=>e(u),j=>{var f=zt(),I=a(f);Et(I,{get objective(){return e(u)},get isSaving(){return e(S)},onSave:Pe,onCancel:()=>v(u,null)}),t(f),N(j,f)});var $e=r(qe,2);R($e,()=>e(h).length>0,j=>{var f=Kt(),I=nt(f),Q=a(I),$=a(Q);yt($,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var W=r($,2);vt(W),t(Q);var Oe=r(Q,2),X=a(Oe);X.__click=[Dt,c,h,V,M,G];var Je=a(X);ht(Je,{size:20}),te(),t(X);var oe=r(X,2);oe.__click=[At,m];var Re=a(oe);wt(Re,{size:20}),te(),t(oe),t(Oe),t(I);var ie=r(I,2),De=a(ie),ne=a(De),Ce=a(ne),Ie=a(Ce),le=a(Ie);le.__click=[Ft,H];var Ue=r(a(le)),We=re(()=>e(b)==="name"?"text-primary":"");kt(Ue,{size:16,get class(){return e(We)}}),t(le),t(Ie),te(6),t(Ce),t(ne);var Ne=r(ne);ct(Ne,21,()=>e(B),_t,(J,L)=>{var me=Mt(),ge=a(me),Ze=a(ge,!0);t(ge);var fe=r(ge),et=a(fe,!0);t(fe);var pe=r(fe),tt=a(pe,!0);t(pe);var be=r(pe),rt=a(be,!0);t(be);var xe=r(be),at=a(xe,!0);t(xe);var ye=r(xe),st=a(ye,!0);t(ye);var Ve=r(ye),Me=a(Ve),ee=a(Me);ee.__click=[Tt,Le,L];var ot=a(ee);St(ot,{size:18}),t(ee);var he=r(ee,2);he.__click=[Vt,u,L];var it=a(he);Pt(it,{size:18}),t(he),t(Me),t(Ve),t(me),Y(()=>{E(Ze,e(L).name),E(et,e(L).strategic_initiatives),E(tt,e(L).kpi),E(rt,e(L).persons_involved),E(at,e(L).target),E(st,e(L).eval_measures)}),N(J,me)}),t(Ne),t(De),t(ie);var ze=r(ie,2),de=a(ze),Xe=a(de);Y(()=>E(Xe,`Showing ${(e(_)-1)*e(l)+1} to ${Math.min(e(_)*e(l),e(P).length)??""} of ${e(P).length??""} results`)),t(de);var Ae=r(de,2),Z=a(Ae),ce=a(Z);ce.value=(ce.__value=5)==null?"":5;var ve=r(ce);ve.value=(ve.__value=10)==null?"":10;var _e=r(ve);_e.value=(_e.__value=25)==null?"":25;var Fe=r(_e);Fe.value=(Fe.__value=50)==null?"":50,t(Z);var ue=r(Z,2);ue.__click=[Gt,_];var Te=r(ue,2);Te.__click=[Lt,_],t(Ae),t(ze),Y(()=>{ue.disabled=e(_)===1,Te.disabled=e(_)===e(n)}),w(W,()=>e(p),J=>v(p,J)),ut(Z,()=>e(l),J=>v(l,J)),N(j,f)},j=>{var f=Ht();N(j,f)}),t(d),Y(()=>{var j;return E(Be,`Strategic Objectives for Goal ${((j=e(c))==null?void 0:j.goal_no)??""}`)}),N(s,d)}),t(ae),N(k,ae),ke()}Se(["click"]);export{_r as component};
