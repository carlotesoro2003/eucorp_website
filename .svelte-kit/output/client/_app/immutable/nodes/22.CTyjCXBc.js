import"../chunks/disclose-version.Bg9kRutz.js";import{f as X,p as Ye,e as C,a as De,b as l,c as t,g as r,h as ze,n as re,r as e,s as d,t as F}from"../chunks/utils.Cx6K9qTo.js";import{e as ae,a as b,d as je,t as k,g as Ce,b as $}from"../chunks/store.BALTJZ26.js";import{i as A}from"../chunks/if.Bgpzl8Wa.js";import{e as Fe,r as H,i as Ee}from"../chunks/attributes.rzeD2olC.js";import{t as E,f as I,s as Ie}from"../chunks/index.3UqCw1jp.js";import{b as O}from"../chunks/input.BVFrb_g3.js";import{l as pe,s as fe,a as V}from"../chunks/preload-helper.Tg4Km7Zr.js";import{o as Le}from"../chunks/index-client.lWLCSZVk.js";import{I as me,a as _e,s as Q}from"../chunks/Icon.Nl6wOSVO.js";import{S as Ne}from"../chunks/search.BpYLThKw.js";import{P as Pe}from"../chunks/plus.Dop3u5ke.js";import{X as ue}from"../chunks/x.D9PBK57y.js";import{P as qe}from"../chunks/pencil.Brzv4RaD.js";import{T as Te}from"../chunks/trash-2.d9YwO6MY.js";function Ae(h,c){const p=pe(c,["children","$$slots","$$events","$$legacy"]);me(h,fe({name:"calendar-range"},()=>p,{iconNode:[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2"}],["path",{d:"M16 2v4"}],["path",{d:"M3 10h18"}],["path",{d:"M8 2v4"}],["path",{d:"M17 14h-6"}],["path",{d:"M13 18H7"}],["path",{d:"M7 14h.01"}],["path",{d:"M17 18h.01"}]],children:(f,M)=>{var o=ae(),g=X(o);_e(g,c,"default",{}),b(f,o)},$$slots:{default:!0}}))}function He(h,c){const p=pe(c,["children","$$slots","$$events","$$legacy"]);me(h,fe({name:"school"},()=>p,{iconNode:[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10"}],["path",{d:"M18 5v17"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6"}],["path",{d:"M6 5v17"}],["circle",{cx:"12",cy:"9",r:"2"}]],children:(f,M)=>{var o=ae(),g=X(o);_e(g,c,"default",{}),b(f,o)},$$slots:{default:!0}}))}const Oe=(h,c,p)=>{l(c,V({id:0,school_year:"",start_date:"",end_date:""})),l(p,!0)};var Qe=k('<div class="mb-6"><div class="bg-destructive/10 text-destructive px-4 py-3 rounded-lg flex items-center gap-2"><!> <p> </p></div></div>'),Ve=k('<div class="flex justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Xe=k('<div class="text-center py-12 bg-card rounded-lg border border-border"><!> <h3 class="text-lg font-semibold mb-2">No School Years Found</h3> <p class="text-muted-foreground">Start by adding a new school year.</p></div>'),Be=(h,c,p)=>c(r(p)),Ge=(h,c,p)=>c(r(p).id),Je=k('<tr class="hover:bg-muted/50 transition-colors"><td class="px-6 py-4 font-medium"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"> </td><td class="px-6 py-4"><div class="flex items-center gap-4"><button class="p-2 hover:bg-muted rounded-lg text-muted-foreground hover:text-foreground" title="Edit"><!></button> <button class="p-2 hover:bg-red-100 text-red-500 hover:text-red-600 rounded-lg disabled:opacity-50" title="Delete"><!></button></div></td></tr>'),Ke=k('<div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><table class="w-full"><thead class="bg-muted/50"><tr><th class="px-6 py-4 text-left font-medium">School Year</th><th class="px-6 py-4 text-left font-medium">Start Date</th><th class="px-6 py-4 text-left font-medium">End Date</th><th class="px-6 py-4 text-left font-medium">Mid Year</th><th class="px-6 py-4 text-left font-medium">Actions</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div>'),Re=k('<div class="fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center p-4 z-50"><div class="bg-card p-6 rounded-lg w-full max-w-md relative border border-border shadow-lg"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-semibold"> </h2> <button class="p-1 hover:bg-muted rounded-lg transition-colors" title="Close"><!></button></div> <form><div class="space-y-4"><div><label for="school_year" class="block text-sm font-medium mb-1">School Year</label> <input id="school_year" type="text" class="w-full px-4 py-2 rounded-lg border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20" placeholder="2023-2024" required></div> <div><label for="start_date" class="block text-sm font-medium mb-1">Start Date</label> <input id="start_date" type="date" class="w-full px-4 py-2 rounded-lg border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20" required></div> <div><label for="end_date" class="block text-sm font-medium mb-1">End Date</label> <input id="end_date" type="date" class="w-full px-4 py-2 rounded-lg border border-border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20" required></div></div> <div class="flex justify-end gap-4 mt-6"><button type="button" class="px-4 py-2 rounded-lg border border-border hover:bg-muted transition-colors">Cancel</button> <button type="submit" class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50"> </button></div></form></div></div>'),Ue=k('<div class="container px-6 py-6 mx-auto"><div class="flex flex-col gap-6 mb-8"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div class="flex items-center gap-2"><!> <h1 class="text-2xl font-bold">School Years Management</h1></div></div> <div class="flex flex-col md:flex-row justify-between gap-4 w-full"><div class="relative flex-1 w-full md:max-w-[300px]"><!> <input type="text" placeholder="Search school years..." class="pl-10 sm:max-w-md px-4 py-2 bg-secondary border-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <div class="flex gap-2 w-full md:w-auto md:justify-end"><button class="flex items-center gap-2 bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors"><!> <span>Add New Year</span></button></div></div></div> <!> <!></div> <!>',1);function pt(h,c){Ye(c,!0);let p=C(V([])),m=C(!1),f=C(null),M=C(!1),o=C(null),g=C("");const oe=ze(()=>r(p).filter(s=>s.school_year.toLowerCase().includes(r(g).toLowerCase()))),B=async()=>{try{l(m,!0),l(f,null);const{data:s,error:a}=await Q.from("school_years").select("*").order("start_date",{ascending:!0});if(a)throw a;l(p,V(s))}catch(s){console.error("Error fetching school years:",s),l(f,"Failed to fetch school years.")}finally{l(m,!1)}},be=(s,a)=>{const v=new Date(s),i=new Date(a);return new Date((v.getTime()+i.getTime())/2).toISOString().split("T")[0]},he=async s=>{if(s.preventDefault(),!!r(o))try{l(m,!0),l(f,null);const a=be(r(o).start_date,r(o).end_date),v={school_year:r(o).school_year,start_date:r(o).start_date,end_date:r(o).end_date,mid_year:a};if(r(o).id){const{error:i}=await Q.from("school_years").update(v).eq("id",r(o).id);if(i)throw i}else{const{error:i}=await Q.from("school_years").insert(v);if(i)throw i}await B(),G()}catch(a){console.error(a),l(f,`Failed to ${r(o).id?"update":"create"} school year.`)}finally{l(m,!1)}},ye=async s=>{if(confirm("Are you sure you want to delete this school year?"))try{l(m,!0),l(f,null);const{error:a}=await Q.from("school_years").delete().eq("id",s);if(a)throw a;await B()}catch(a){console.error("Error deleting school year:",a),l(f,"Failed to delete school year.")}finally{l(m,!1)}},G=()=>{l(M,!1),l(o,null)},ge=s=>{l(o,V({...s})),l(M,!0)},J=s=>new Date(s).toLocaleDateString();Le(()=>{B()});var se=Ue(),K=X(se),R=t(K),U=t(R),de=t(U),xe=t(de);He(xe,{class:"w-8 h-8 text-primary"}),re(2),e(de),e(U);var le=d(U,2),W=t(le),ie=t(W);Ne(ie,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var ne=d(ie,2);H(ne),e(W);var ce=d(W,2),Z=t(ce);Z.__click=[Oe,o,M];var we=t(Z);Pe(we,{size:20}),re(2),e(Z),e(ce),e(le),e(R);var ve=d(R,2);A(ve,()=>r(f),s=>{var a=Qe(),v=t(a),i=t(v);ue(i,{size:20});var n=d(i,2),y=t(n,!0);e(n),e(v),e(a),F(()=>$(y,r(f))),E(3,a,()=>I),b(s,a)});var Se=d(ve,2);A(Se,()=>r(m),s=>{var a=Ve();E(3,a,()=>I),b(s,a)},s=>{var a=ae(),v=X(a);A(v,()=>r(oe).length===0,i=>{var n=Xe(),y=t(n);Ae(y,{size:48,class:"mx-auto text-muted-foreground mb-4"}),re(4),e(n),E(3,n,()=>I),b(i,n)},i=>{var n=Ke(),y=t(n),Y=d(t(y));Fe(Y,21,()=>r(oe),Ee,(ee,_)=>{var x=Je(),w=t(x),L=t(w,!0);e(w);var S=d(w),N=t(S,!0);F(()=>$(N,J(r(_).start_date))),e(S);var D=d(S),P=t(D,!0);F(()=>$(P,J(r(_).end_date))),e(D);var z=d(D),q=t(z,!0);F(()=>$(q,r(_).mid_year?J(r(_).mid_year):"-")),e(z);var j=d(z),T=t(j),u=t(T);u.__click=[Be,ge,_];var ke=t(u);qe(ke,{size:18}),e(u);var te=d(u,2);te.__click=[Ge,ye,_];var Me=t(te);Te(Me,{size:18}),e(te),e(T),e(j),e(x),F(()=>$(L,r(_).school_year)),b(ee,x)}),e(Y),e(y),e(n),E(3,n,()=>I),b(i,n)},!0),b(s,a)}),e(K);var $e=d(K,2);A($e,()=>r(M),s=>{var a=Re(),v=t(a),i=t(v),n=t(i),y=t(n,!0);e(n);var Y=d(n,2);Y.__click=G;var ee=t(Y);ue(ee,{size:20}),e(Y),e(i);var _=d(i,2),x=t(_),w=t(x),L=d(t(w),2);H(L),e(w);var S=d(w,2),N=d(t(S),2);H(N),e(S);var D=d(S,2),P=d(t(D),2);H(P),e(D),e(x);var z=d(x,2),q=t(z);q.__click=G;var j=d(q,2),T=t(j,!0);e(j),e(z),e(_),e(v),e(a),F(()=>{var u;$(y,(u=r(o))!=null&&u.id?"Edit School Year":"Create School Year"),j.disabled=r(m),$(T,r(m)?"Saving...":"Save")}),Ce("submit",_,he),O(L,()=>r(o).school_year,u=>r(o).school_year=u),O(N,()=>r(o).start_date,u=>r(o).start_date=u),O(P,()=>r(o).end_date,u=>r(o).end_date=u),E(3,v,()=>Ie,()=>({duration:200})),E(3,a,()=>I),b(s,a)}),O(ne,()=>r(g),s=>l(g,s)),b(h,se),De()}je(["click"]);export{pt as component};
