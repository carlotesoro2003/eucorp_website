import"../chunks/disclose-version.Bg9kRutz.js";import{f as ve,p as ue,g as e,a as pe,c as a,r as t,s,t as q,h as O,n as se,e as k,b as p}from"../chunks/utils.Cx6K9qTo.js";import{e as xe,a as S,d as oe,t as E,b as y}from"../chunks/store.BALTJZ26.js";import{i as _e}from"../chunks/if.Bgpzl8Wa.js";import{e as me,i as ge,r as he}from"../chunks/attributes.rzeD2olC.js";import{b as ye}from"../chunks/input.BVFrb_g3.js";import{b as fe}from"../chunks/select.BtlRD387.js";import{l as we,s as ke,p as Se,a as C}from"../chunks/preload-helper.Tg4Km7Zr.js";import{I as Ie,a as Ge,s as ce}from"../chunks/Icon.Nl6wOSVO.js";import{g as Pe}from"../chunks/entry.CMKkUr-m.js";import{A as re}from"../chunks/arrow-up-down.CZ0J7o1e.js";import{E as Me}from"../chunks/eye.CaP1-WUo.js";import{S as Ce}from"../chunks/search.BpYLThKw.js";import{D as Ee}from"../chunks/download.K4Jw1XP8.js";function ze(_,r){const b=we(r,["children","$$slots","$$events","$$legacy"]);Ie(_,ke({name:"notebook"},()=>b,{iconNode:[["path",{d:"M2 6h4"}],["path",{d:"M2 10h4"}],["path",{d:"M2 14h4"}],["path",{d:"M2 18h4"}],["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}],["path",{d:"M16 2v20"}]],children:(d,c)=>{var u=xe(),m=ve(u);Ge(m,r,"default",{}),S(d,u)},$$slots:{default:!0}}))}var Fe=E('<div class="p-4 border-b border-border"><h3 class="font-semibold"> </h3> <p class="text-sm text-muted-foreground"> </p></div>'),Oe=(_,r)=>r.toggleSort("name"),Ae=(_,r)=>r.toggleSort("kpi"),je=(_,r)=>r.toggleSort("target"),Ne=(_,r,b)=>r(e(b).id),De=E('<tr class="hover:bg-muted/50"><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden md:table-cell"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden lg:table-cell"> </td><td class="px-4 py-3"> </td><td class="px-4 py-3 hidden xl:table-cell"> </td><td class="px-4 py-3"><button class="btn btn-ghost btn-sm text-blue-500" title="View Action Plans"><!></button></td></tr>'),Le=E('<div class="overflow-x-auto bg-card rounded-lg shadow border border-border"><!> <table class="min-w-full table-auto"><thead class="bg-muted/50"><tr><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Objective <!></button></th><th class="px-4 py-3 text-left hidden md:table-cell">Strategic Initiatives</th><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">KPI <!></button></th><th class="px-4 py-3 text-left hidden lg:table-cell">Persons Involved</th><th class="px-4 py-3 text-left"><button class="flex items-center gap-1 hover:text-primary">Target <!></button></th><th class="px-4 py-3 text-left hidden xl:table-cell">Evaluation Measures</th><th class="px-4 py-3 text-left w-[120px]">Action</th></tr></thead><tbody class="divide-y divide-border"></tbody></table></div>');function Te(_,r){ue(r,!0);const b=G=>{Pe(`/plans/operationalPlans/${G}`)};var n=Le(),d=a(n);_e(d,()=>r.selectedGoal,G=>{var g=Fe(),x=a(g),w=a(x);t(x);var N=s(x,2),P=a(N,!0);t(N),t(g),q(()=>{y(w,`Strategic Goal No ${r.selectedGoal.goal_no??""}`),y(P,r.selectedGoal.name)}),S(G,g)});var c=s(d,2),u=a(c),m=a(u),i=a(m),v=a(i);v.__click=[Oe,r];var I=s(a(v)),T=O(()=>r.sortField==="name"?"text-primary":"");re(I,{size:16,get class(){return e(T)}}),t(v),t(i);var $=s(i,2),A=a($);A.__click=[Ae,r];var H=s(a(A)),J=O(()=>r.sortField==="kpi"?"text-primary":"");re(H,{size:16,get class(){return e(J)}}),t(A),t($);var z=s($,2),K=a(z);K.__click=[je,r];var W=s(a(K)),R=O(()=>r.sortField==="target"?"text-primary":"");re(W,{size:16,get class(){return e(R)}}),t(K),t(z),se(2),t(m),t(u);var j=s(u);me(j,21,()=>r.items,ge,(G,g)=>{var x=De(),w=a(x),N=a(w,!0);t(w);var P=s(w),U=a(P,!0);t(P);var D=s(P),B=a(D,!0);t(D);var F=s(D),X=a(F,!0);t(F);var V=s(F),o=a(V,!0);t(V);var l=s(V),L=a(l,!0);t(l);var h=s(l),M=a(h);M.__click=[Ne,b,g];var f=a(M);Me(f,{size:18}),t(M),t(h),t(x),q(()=>{y(N,e(g).name),y(U,e(g).strategic_initiatives),y(B,e(g).kpi),y(X,e(g).persons_involved),y(o,e(g).target),y(L,e(g).eval_measures)}),S(G,x)}),t(j),t(c),t(n),S(_,n),pe()}oe(["click"]);var $e=E("<option> </option>"),Ke=E('<div class="w-full md:w-[300px]"><label class="block mb-2 font-medium">Select Strategic Goal:</label> <select class="select select-bordered w-full bg-secondary border-secondary rounded-lg"><option disabled selected>Select a goal</option><!></select></div>');function Re(_,r){let b=Se(r,"selectedGoalId",15,null);var n=Ke(),d=s(a(n),2);d.__change=function(...m){var i;(i=r.onSelect)==null||i.apply(this,m)};var c=a(d);c.value=((c.__value="")==null,"");var u=s(c);me(u,17,()=>r.goals,ge,(m,i)=>{var v=$e(),I={},T=a(v);t(v),q(()=>{I!==(I=e(i).id)&&(v.value=(v.__value=e(i).id)==null?"":e(i).id),y(T,`${e(i).goal_no??""} - ${e(i).name??""}`)}),S(m,v)}),t(d),t(n),fe(d,b),S(_,n)}oe(["change"]);var Ue=E('<div class="flex justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Ve=(_,r)=>p(r,e(r)-1),qe=(_,r)=>p(r,e(r)+1),Be=E('<!> <div class="flex flex-col sm:flex-row justify-between items-center gap-4"><div class="text-sm text-muted-foreground"> </div> <div class="flex flex-col sm:flex-row items-center gap-4"><select class="bg-secondary border-secondary rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-ring w-full sm:w-auto"><option>5 per page</option><option>10 per page</option><option>25 per page</option><option>50 per page</option></select> <div class="flex gap-2"><button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Previous</button> <button class="px-3 py-1 rounded-lg border border-border hover:bg-muted disabled:opacity-50">Next</button></div></div></div>',1),Qe=E('<div class="flex flex-col gap-4 container mx-auto p-4"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div class="flex items-center gap-2"><!> <h1 class="text-2xl font-bold">Operational Plans Management</h1></div></div> <div class="flex flex-col md:flex-row justify-between items-center gap-4"><div class="flex flex-shrink-0 w-full md:w-auto"><!></div> <div class="flex items-center gap-4 w-full md:w-auto"><div class="relative flex-1"><!> <input type="text" placeholder="Search objectives..." class="pl-10 pr-4 py-2 bg-secondary border-secondary rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-ring"></div> <button class="flex items-center gap-2 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/80"><!> Export</button></div></div> <!></div>');function nt(_,r){ue(r,!0);let b=k(""),n=k(1),d=k(5),c=k("name"),u=k("asc"),m=k(!0),i=k(null),v=k(C([])),I=k(C([]));const T=async()=>{await $(),e(v).length>0&&(p(i,C(e(v)[0].id)),await A()),p(m,!1)},$=async()=>{const{data:o,error:l}=await ce.from("strategic_goals").select("id, name, goal_no");l?console.error("Error fetching strategic goals:",l):p(v,C(o||[]))},A=async()=>{if(!e(i))return;p(m,!0);const{data:o,error:l}=await ce.from("strategic_objectives").select("*").eq("strategic_goal_id",e(i));l?console.error("Error fetching strategic objectives:",l):p(I,C(o||[])),p(m,!1)},H=o=>{e(c)===o?p(u,C(e(u)==="asc"?"desc":"asc")):(p(c,C(o)),p(u,"asc"))},J=()=>{const l=[["Objective","Strategic Initiatives","KPI","Persons Involved","Target","Evaluation Measures"].join(","),...e(I).map(f=>[f.name,f.strategic_initiatives,f.kpi,f.persons_involved,f.target,f.eval_measures].join(","))].join(`
`),L=new Blob([l],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),M=URL.createObjectURL(L);h.setAttribute("href",M),h.setAttribute("download","objectives.csv"),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h)},z=O(()=>e(I).filter(o=>`${o.name} ${o.strategic_initiatives} ${o.kpi}`.toLowerCase().includes(e(b).toLowerCase())).sort((o,l)=>e(u)==="asc"?o[e(c)].localeCompare(l[e(c)]):l[e(c)].localeCompare(o[e(c)]))),K=O(()=>e(z).slice((e(n)-1)*e(d),e(n)*e(d))),W=O(()=>Math.ceil(e(z).length/e(d)));T();var R=Qe(),j=a(R),G=a(j),g=a(G);ze(g,{class:"w-8 h-8 text-primary"}),se(2),t(G),t(j);var x=s(j,2),w=a(x),N=a(w);Re(N,{get goals(){return e(v)},get selectedGoalId(){return e(i)},set selectedGoalId(o){p(i,C(o))},onSelect:A}),t(w);var P=s(w,2),U=a(P),D=a(U);Ce(D,{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",size:20});var B=s(D,2);he(B),t(U);var F=s(U,2);F.__click=J;var X=a(F);Ee(X,{size:20}),se(),t(F),t(P),t(x);var V=s(x,2);_e(V,()=>e(m),o=>{var l=Ue();S(o,l)},o=>{var l=Be(),L=ve(l),h=O(()=>e(v).find(ae=>ae.id===e(i)));Te(L,{get items(){return e(K)},get sortField(){return e(c)},get sortDirection(){return e(u)},toggleSort:H,get selectedGoal(){return e(h)}});var M=s(L,2),f=a(M),be=a(f);q(()=>y(be,`Showing ${(e(n)-1)*e(d)+1} to ${Math.min(e(n)*e(d),e(z).length)??""} of ${e(z).length??""} results`)),t(f);var le=s(f,2),Q=a(le),Y=a(Q);Y.value=(Y.__value=5)==null?"":5;var Z=s(Y);Z.value=(Z.__value=10)==null?"":10;var ee=s(Z);ee.value=(ee.__value=25)==null?"":25;var ie=s(ee);ie.value=(ie.__value=50)==null?"":50,t(Q);var ne=s(Q,2),te=a(ne);te.__click=[Ve,n];var de=s(te,2);de.__click=[qe,n],t(ne),t(le),t(M),q(()=>{te.disabled=e(n)===1,de.disabled=e(n)===e(W)}),fe(Q,()=>e(d),ae=>p(d,ae)),S(o,l)}),t(R),ye(B,()=>e(b),o=>p(b,o)),S(_,R),pe()}oe(["click"]);export{nt as component};
